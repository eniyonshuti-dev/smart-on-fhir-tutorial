<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>SMART Launch</title>
  <script src="https://cdn.jsdelivr.net/npm/fhirclient@latest/build/fhir-client.js"></script>
</head>
<body>
<script>
  // Make fhirclient store launch state reliably on static hosts
  FHIR.oauth2.settings.fullSessionStorageSupport = true;

  const CLIENT_ID = "ba92e811-144a-412c-ac69-2a0cdd1abc9f"; // your Provider app client_id
  const REDIRECT  = "https://eniyonshuti-dev.github.io/smart-on-fhir-tutorial/example-smart-app/"; // <-- trailing slash

  const q = new URLSearchParams(location.search);
  const iss    = q.get("iss");
  const launch = q.get("launch");

  FHIR.oauth2.authorize({
    clientId: CLIENT_ID,
    redirectUri: REDIRECT,
    iss,
    launch,
    completeInTarget: true,                // ← avoids multi-window state issues
    scope: [
      "launch","launch/patient",
      "openid","profile","fhirUser",
      "patient/*.read",                    // keeps demo simple
      "user/Patient.read"                  // covers some provider-token styles
    ].join(" ")
  });
</script>
</body>
</html>


