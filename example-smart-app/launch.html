<script src="https://cdn.jsdelivr.net/npm/fhirclient@latest/build/fhir-client.js"></script>
<script>
  FHIR.oauth2.settings.fullSessionStorageSupport = true;

  const CLIENT_ID = "6a0f3954-d0f7-452d-aecf-f64f8fadb8a2"; // your PATIENT app id
  const REDIRECT  = "https://eniyonshuti-dev.github.io/smart-on-fhir-tutorial/example-smart-app/";

  const q = new URLSearchParams(location.search);
  const iss    = q.get("iss");
  const launch = q.get("launch");

  const scope = [
    "launch", "launch/patient",
    "openid", "profile", "fhirUser",
    // explicit data scopes (avoid wildcard)
    "patient/Patient.read",
    "patient/Observation.read",
    "patient/MedicationRequest.read",
    "patient/Condition.read",
    "patient/Encounter.read",
    "patient/AllergyIntolerance.read"
  ].join(" ");

  // small debug so you see whatâ€™s deployed
  document.body.insertAdjacentHTML("beforeend",
    `<pre>client_id: ${CLIENT_ID}\nrequesting:\n${scope}</pre>`);

  FHIR.oauth2.authorize({
    clientId: CLIENT_ID,
    redirectUri: REDIRECT,
    iss, launch,
    completeInTarget: true,
    scope
  });
</script>
